<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="reveal.js/css/reveal.css"/>
  <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
    </style>
    <link rel="stylesheet" href="vendor/font-awesome-4.3.0/css/font-awesome.css"/>
    <link rel="stylesheet" href="reveal.js/css/theme/white.css"/>
  <link rel="stylesheet" media="print" href="reveal.js/css/print/pdf.css" />
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
    <title>Functional Programming in Industry</title>
    <link rel="stylesheet" href="css/slides.css"/>
</head>
<body>
  <div class="reveal">
    <div class="slides">


<section id="title" class="slide level1">
<h1>Functional Programming in Industry</h1>
<h3>
    
Bob Ippolito (<a href="https://twitter.com/etrepum"><span class="citation" data-cites="etrepum">@etrepum</span></a>)<br> <a href="http://hightechnorway.com/">High Tech Norway</a><br> June 17, 2015
</h3>
<h4>
<a href="http://bob.ippoli.to/fp-htn-2015/">bob.ippoli.to/fp-htn-2015</a>
</h4>

</section>
<section id="who-am-i" class="slide level1">
<h1>Who am I?</h1>
<ul>
<li>Self-taught programmer</li>
<li>Open source contributor (Python, JS, Erlang, Haskell)</li>
<li>Entrepreneur (past: Mochi Media, Pieceable)</li>
<li>Angel Investor &amp; Startup Advisor</li>
<li>Current Projects: Mission Bit</li>
</ul>
</section>
<section id="mission-bit" class="slide level1">
<h1>Mission Bit</h1>
<p><img src="images/missionbit-logo.svg" class="mission-bit-logo" /></p>
<ul>
<li>501c3 non-profit in San Francisco</li>
<li>Free after-school coding classes</li>
<li>High school and middle school</li>
<li>Taught by volunteer tech professionals</li>
<li>Also: summer internships, company visits, hacker lab, etc.</li>
<li><a href="http://www.missionbit.com/">missionbit.com</a></li>
</ul>
</section>
<section id="imperative-programming" class="slide level1">
<h1>Imperative Programming</h1>
<blockquote>
In computer science terminologies, imperative programming is a programming paradigm that describes computation in terms of <strong>statements that change a program state</strong>.
<footer>
– <cite><a href="http://en.wikipedia.org/wiki/Imperative%20Programming">Wikipedia: Imperative Programming</a></cite>
</footer>
</blockquote>

</section>
<section id="functional-programming" class="slide level1">
<h1>Functional Programming</h1>
<blockquote>
In computer science, functional programming is a programming paradigm—a style of building the structure and elements of computer programs—that treats computation as the evaluation of mathematical functions and <strong>avoids changing-state and mutable data</strong>.
<footer>
– <cite><a href="http://en.wikipedia.org/wiki/Functional%20Programming">Wikipedia: Functional Programming</a></cite>
</footer>
</blockquote>

</section>
<section id="clarifications" class="slide level1">
<h1>Clarifications</h1>
<ul>
<li>The important part is the programming abstraction, of course every runtime computation is using mutability somewhere</li>
<li>Is a <em>style</em> of programming, can be done in any language</li>
<li>Often easier or more efficient to use a language designed for FP</li>
</ul>
</section>
<section id="popular-languages-for-fp" class="slide level1">
<h1>Popular Languages for FP</h1>
<ul>
<li>Scala (JVM)</li>
<li>Haskell</li>
<li>Clojure (JVM)</li>
<li>Erlang</li>
<li>OCaml</li>
<li>F# (CLR)</li>
<li>Elixir (Erlang VM)</li>
</ul>
</section>
<section id="scala-usage" class="slide level1">
<h1>Scala Usage</h1>
<ul>
<li>LinkedIn</li>
<li>Twitter</li>
<li>Opower</li>
<li>Coursera</li>
</ul>
</section>
<section id="haskell-usage" class="slide level1">
<h1>Haskell Usage</h1>
<ul>
<li>Finance (JP Morgan, Standard Chartered, Barclays, …)</li>
<li>Facebook</li>
<li>Microsoft</li>
<li>IMVU</li>
<li>Janrain</li>
<li>Galois</li>
</ul>
</section>
<section id="erlang-usage" class="slide level1">
<h1>Erlang Usage</h1>
<ul>
<li>Telecom (Ericsson, Nokia, AT&amp;T, …)</li>
<li>Cloud (Heroku, Chef, VMWare, …)</li>
<li>Advertising (AdRoll, OpenX, AdGear, AOL, …)</li>
<li>Messaging (WhatsApp, TigerText, 2600hz)</li>
<li>Gaming (Machine Zone, Spilgames, Wooga, …)</li>
<li>Finance (Klarna, Smarkets)</li>
</ul>
</section>
<section id="erlang-success-stories" class="slide level1">
<h1>Erlang Success Stories</h1>
<ul>
<li>Machine Zone (<a href="http://fortune.com/2014/07/16/machine-zone-funding/">2014</a>, ~$3B valuation, Game of War!)</li>
<li>WhatsApp (<a href="http://www.bloomberg.com/news/articles/2014-10-28/facebook-s-22-billion-whatsapp-deal-buys-10-million-in-sales">2014</a>, $22B acquisition by Facebook)</li>
<li>Tail-f (<a href="http://newsroom.cisco.com/release/1451764">2014</a>, $175M acquisition by Cisco)</li>
<li>Cloudant (<a href="http://www-03.ibm.com/press/us/en/pressrelease/43342.wss">2014</a>, acquired by IBM)</li>
<li>Mochi Media (<a href="http://www.wsj.com/articles/SB10001424052748704081704574653430020773954">2010</a>, $80M acquisition by Shanda Games)</li>
<li>Heroku (<a href="http://techcrunch.com/2010/12/08/breaking-salesforce-buys-heroku-for-212-million-in-cash/">2010</a>, $212M acquisition by Salesforce)</li>
<li>Bluetail (<a href="http://www.wsj.com/articles/SB967466988486238924">2000</a>, $152M acquisition by Nortel)</li>
</ul>
</section>
<section id="caveat-emptor" class="slide level1">
<h1>Caveat Emptor</h1>
<p>Using Erlang will probably not make you rich!<br><br> <small>… but JavaScript probably isn't doing you any favors either ;)</small></p>
</section>
<section id="popularity-cons" class="slide level1">
<h1>Popularity Cons</h1>
<ul>
<li>Fewer learning resources available</li>
<li>Unlikely to find a fancy IDE (unless Emacs counts)</li>
<li>Fewer programmers available, may be harder to hire<br> … but you may find better ones (<a href="http://www.paulgraham.com/avg.html">Blub Paradox</a>)</li>
<li>Fewer open source libraries available<br> … but maybe you waste less time on bad ones ;)</li>
</ul>
</section>
<section id="technical-cons" class="slide level1">
<h1>Technical Cons</h1>
<ul>
<li>Garbage Collection is basically a hard requirement<br> … but unless you're still using C++, this is status quo</li>
<li>Pure algorithms may have an extra <code>n</code> or <code>log n</code> time cost<br> … but there's usually a way to cheat</li>
<li>Shared state (e.g. configuration) can be cumbersome<br> … but globals are bad practice anyway</li>
</ul>
</section>
<section id="pre-history" class="slide level1">
<h1>Pre-History</h1>
<dl>
<dt>1930s-1950s</dt>
<dd>Lambda Calculus (Turing)
</dd>
<dd>Combinatory Calculus (Curry &amp; Feys)
</dd>
<dd>LISP (McCarthy)
</dd>
<dt>1960s-1970s</dt>
<dd>Operational (Landin) and Denotational (Strachey) semantics
</dd>
<dd>ML (Milner)
</dd>
<dd>Lazy FP &amp; Graph Reduction (Turner)
</dd>
<dt>1980s</dt>
<dd>Miranda (Turner)
</dd>
<dd>Lazy ML (Augustsson &amp; Johnsson)
</dd>
</dl>
</section>
<section id="abbreviated-history" class="slide level1">
<h1>Abbreviated History</h1>
<dl>
<dt>1987</dt>
<dd>Erlang experiments at Ericsson's R&amp;D lab
</dd>
<dd>Haskell committee formed
</dd>
<dt>1990</dt>
<dd>Haskell 1.0
</dd>
<dt>1998</dt>
<dd>Erlang open sourced
</dd>
<dt>2004</dt>
<dd>Scala public release
</dd>
<dt>2007</dt>
<dd>Clojure public release
</dd>
</dl>
</section>
<section id="why-so-long" class="slide level1">
<h1>Why so long?</h1>
<ul>
<li>Compiling FP style code to efficient machine code is a harder problem than adding layers of abstraction to how the machine already works.</li>
<li>FP languages haven't had as many corporations pushing their adoption.</li>
</ul>
</section>
<section id="why-now" class="slide level1">
<h1>Why now?</h1>
<ul>
<li>The imperative languages we have are a mess.</li>
<li>Particularly with regard to concurrency and parallelism.</li>
<li>Even embedded devices are multi-core today.</li>
<li>FP can make multi-core and distributed systems easier to build.</li>
</ul>
</section>
<section id="pros" class="slide level1">
<h1>Pros</h1>
<ul>
<li>Code is more declarative; what to do, not how to do it.</li>
<li>Erlang and Haskell have cheap concurrency, no more callback spaghetti.</li>
<li>Erlang was designed for uptime. Introspection, resiliency and upgrade paths are built-in.</li>
</ul>
</section>
<section id="declarative" class="slide level1">
<h1>Declarative</h1>
<p>Describe the problem, not the solution.</p>
</section>
<section id="merge-sort-python" class="slide level1 small-code">
<h1></h1>
<pre class="sourceCode python"><code class="sourceCode python"><span class="co"># merge_sort.py</span>
<span class="kw">def</span> merge_sort(lst):
    <span class="kw">if</span> not lst:
        <span class="kw">return</span> []
    lists = [[x] <span class="kw">for</span> x in lst]
    <span class="kw">while</span> <span class="dt">len</span>(lists) &gt; <span class="dv">1</span>:
        lists = merge_lists(lists)
    <span class="kw">return</span> lists[<span class="dv">0</span>]

<span class="kw">def</span> merge_lists(lists):
    result = []
    <span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">0</span>, <span class="dt">len</span>(lists) // <span class="dv">2</span>):
        result.append(merge2(lists[i*<span class="dv">2</span>], lists[i*<span class="dv">2</span> + <span class="dv">1</span>]))
    <span class="kw">if</span> <span class="dt">len</span>(lists) % <span class="dv">2</span>:
        result.append(lists[-<span class="dv">1</span>])
    <span class="kw">return</span> result

<span class="kw">def</span> merge2(xs, ys):
    i = <span class="dv">0</span>
    j = <span class="dv">0</span>
    result = []
    <span class="kw">while</span> i &lt; <span class="dt">len</span>(xs) and j &lt; <span class="dt">len</span>(ys):
        x = xs[i]
        y = ys[j]
        <span class="kw">if</span> x &gt; y:
            result.append(y)
            j += <span class="dv">1</span>
        <span class="kw">else</span>:
            result.append(x)
            i += <span class="dv">1</span>
    result.extend(xs[i:])
    result.extend(ys[j:])
    <span class="kw">return</span> result</code></pre>
</section>
<section id="merge-sort-erlang" class="slide level1">
<h1></h1>
<pre class="sourceCode erlang"><code class="sourceCode erlang"><span class="kw">-module</span><span class="fu">(</span><span class="ch">merge_sort</span><span class="fu">).</span>
<span class="kw">-export</span><span class="fu">([</span><span class="ch">merge_sort</span><span class="kw">/</span><span class="dv">1</span><span class="fu">]).</span>

<span class="co">% bottom-up merge sort</span>
<span class="fu">merge_sort([])</span> <span class="kw">-&gt;</span>
    <span class="fu">[];</span>
<span class="fu">merge_sort(</span><span class="dt">L</span><span class="fu">)</span> <span class="kw">-&gt;</span>
    <span class="fu">iterate([[</span><span class="dt">X</span><span class="fu">]</span> <span class="fu">||</span> <span class="dt">X</span> <span class="kw">&lt;-</span> <span class="dt">L</span><span class="fu">]).</span>

<span class="fu">iterate([</span><span class="dt">Xs</span><span class="fu">])</span> <span class="kw">-&gt;</span>
    <span class="dt">Xs</span><span class="fu">;</span>
<span class="fu">iterate(</span><span class="dt">Lists</span><span class="fu">)</span> <span class="kw">-&gt;</span>
    <span class="fu">iterate(merge_lists(</span><span class="dt">Lists</span><span class="fu">)).</span>

<span class="fu">merge_lists([</span><span class="dt">Xs</span><span class="fu">,</span> <span class="dt">Ys</span> <span class="fu">|</span> <span class="dt">Rest</span><span class="fu">])</span> <span class="kw">-&gt;</span>
    <span class="fu">[merge2(</span><span class="dt">Xs</span><span class="fu">,</span> <span class="dt">Ys</span><span class="fu">)</span> <span class="fu">|</span> <span class="fu">merge_lists(</span><span class="dt">Rest</span><span class="fu">)];</span>
<span class="fu">merge_lists(</span><span class="dt">Lists</span><span class="fu">)</span> <span class="kw">-&gt;</span>
    <span class="dt">Lists</span><span class="fu">.</span>

<span class="fu">merge2(</span><span class="dt">Xs</span><span class="kw">=</span><span class="fu">[</span><span class="dt">X</span> <span class="fu">|</span> <span class="dt">_</span><span class="fu">],</span> <span class="fu">[</span><span class="dt">Y</span> <span class="fu">|</span> <span class="dt">Ys</span><span class="fu">])</span> <span class="ch">when</span> <span class="dt">X</span> <span class="kw">&gt;</span> <span class="dt">Y</span> <span class="kw">-&gt;</span>
    <span class="fu">[</span><span class="dt">Y</span> <span class="fu">|</span> <span class="fu">merge2(</span><span class="dt">Xs</span><span class="fu">,</span> <span class="dt">Ys</span><span class="fu">)];</span>
<span class="fu">merge2([</span><span class="dt">X</span> <span class="fu">|</span> <span class="dt">Xs</span><span class="fu">],</span> <span class="dt">Ys</span><span class="fu">)</span> <span class="kw">-&gt;</span>
    <span class="fu">[</span><span class="dt">X</span> <span class="fu">|</span> <span class="fu">merge2(</span><span class="dt">Xs</span><span class="fu">,</span> <span class="dt">Ys</span><span class="fu">)];</span>
<span class="fu">merge2([],</span> <span class="dt">Ys</span><span class="fu">)</span> <span class="kw">-&gt;</span>
    <span class="dt">Ys</span><span class="fu">.</span></code></pre>
</section>
<section id="merge-sort-haskell" class="slide level1">
<h1></h1>
<pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">module</span> <span class="dt">MergeSort</span> (mergeSort) <span class="kw">where</span>

<span class="co">-- | Bottom-up merge sort.</span>
<span class="ot">mergeSort ::</span> <span class="dt">Ord</span> a <span class="ot">=&gt;</span> [a] <span class="ot">-&gt;</span> [a]
mergeSort <span class="fu">=</span> mergeAll <span class="fu">.</span> map (<span class="fu">:</span>[])
  <span class="kw">where</span>
    mergeAll []   <span class="fu">=</span> []
    mergeAll [xs] <span class="fu">=</span> xs
    mergeAll xss  <span class="fu">=</span> mergeAll (mergePairs xss)

    mergePairs (a<span class="fu">:</span>b<span class="fu">:</span>xs) <span class="fu">=</span>
      merge a b <span class="fu">:</span> mergePairs xs
    mergePairs xs <span class="fu">=</span> xs

    merge as<span class="fu">@</span>(a<span class="fu">:</span>as&#39;) bs<span class="fu">@</span>(b<span class="fu">:</span>bs&#39;)
      <span class="fu">|</span> a <span class="fu">&gt;</span> b     <span class="fu">=</span> b <span class="fu">:</span> merge as bs&#39;
      <span class="fu">|</span> otherwise <span class="fu">=</span> a <span class="fu">:</span> merge as&#39; bs
    merge [] bs <span class="fu">=</span> bs
    merge as [] <span class="fu">=</span> as</code></pre>
</section>
<section id="parse-tcp-erlang" class="slide level1">
<h1></h1>
<p>Erlang has convenient bit syntax for parsing binary data</p>
<pre class="sourceCode erlang"><code class="sourceCode erlang"><span class="co">%% This parses a TCP packet header (IPv4)!</span>
<span class="kw">&lt;&lt;</span> <span class="dt">SourcePort</span><span class="fu">:</span><span class="dv">16</span><span class="fu">,</span> <span class="dt">DestinationPort</span><span class="fu">:</span><span class="dv">16</span><span class="fu">,</span> <span class="dt">SequenceNumber</span><span class="fu">:</span><span class="dv">32</span><span class="fu">,</span>
   <span class="dt">AckNumber</span><span class="fu">:</span><span class="dv">32</span><span class="fu">,</span> <span class="dt">DataOffset</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">_Reserved</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">Flags</span><span class="fu">:</span><span class="dv">8</span><span class="fu">,</span>
   <span class="dt">WindowSize</span><span class="fu">:</span><span class="dv">16</span><span class="fu">,</span> <span class="dt">Checksum</span><span class="fu">:</span><span class="dv">16</span><span class="fu">,</span> <span class="dt">UrgentPointer</span><span class="fu">:</span><span class="dv">16</span><span class="fu">,</span>
   <span class="dt">Payload</span><span class="kw">/</span><span class="ch">binary</span> <span class="kw">&gt;&gt;</span> <span class="kw">=</span> <span class="dt">Segment</span><span class="fu">,</span>
<span class="dt">OptSize</span> <span class="kw">=</span> <span class="fu">(</span><span class="dt">DataOffset</span> <span class="kw">-</span> <span class="dv">5</span><span class="fu">)</span><span class="kw">*</span><span class="dv">32</span><span class="fu">,</span>
<span class="kw">&lt;&lt;</span> <span class="dt">Options</span><span class="fu">:</span><span class="dt">OptSize</span><span class="fu">,</span> <span class="dt">Message</span><span class="kw">/</span><span class="ch">binary</span> <span class="kw">&gt;&gt;</span> <span class="kw">=</span> <span class="dt">Payload</span><span class="fu">,</span>
<span class="kw">&lt;&lt;</span> <span class="dt">CWR</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span> <span class="dt">ECE</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span> <span class="dt">URG</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span> <span class="dt">ACK</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span> <span class="dt">PSH</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span>
   <span class="dt">RST</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span> <span class="dt">SYN</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span> <span class="dt">FIN</span><span class="fu">:</span><span class="dv">1</span><span class="kw">&gt;&gt;</span> <span class="kw">=</span> <span class="kw">&lt;&lt;</span><span class="dt">Flags</span><span class="fu">:</span><span class="dv">8</span><span class="kw">&gt;&gt;</span><span class="fu">,</span>

<span class="co">%% Can now process the Message according to the</span>
<span class="co">%% Options (if any) and the flags CWR, …, FIN etc.</span></code></pre>
</section>
<section id="cheap-concurrency" class="slide level1">
<h1>Cheap Concurrency</h1>
<ul>
<li>Immutable data is lock-free, no deadlocks if there are no locks.</li>
<li>&lt;3 KB minimum per thread (process in Erlang terminology)</li>
<li>High performance IO multiplexing built-in</li>
<li>Can have millions of threads, even more than one per socket</li>
</ul>
</section>
<section id="cost-of-concurrency" class="slide level1">
<h1></h1>
<p>RAM footprint per unit of concurrency (approx)</p>
<table id="concurrency-table">
<tr class="haskell">
<td class="num">
1.3KB
</td>
<td class="name">
<div class="bar-ctr">
<div class="bar">

</div>
</div>
<span>Haskell ThreadId + MVar (GHC 7.6.3, 64-bit)</span>
</td>
</tr>
<tr class="erlang">
<td class="num">
2.6 KB
</td>
<td class="name">
<div class="bar-ctr">
<div class="bar">

</div>
</div>
<span>Erlang process (64-bit)</span>
</td>
</tr>
<tr class="go">
<td class="num">
8.0 KB
</td>
<td class="name">
<div class="bar-ctr">
<div class="bar">

</div>
</div>
<span>Go goroutine</span>
</td>
</tr>
<tr class="java-min">
<td class="num">
64.0 KB
</td>
<td class="name">
<div class="bar-ctr">
<div class="bar">

</div>
</div>
<span>Java thread stack (minimum)</span>
</td>
</tr>
<tr class="c-min">
<td class="num">
64.0 KB
</td>
<td class="name">
<div class="bar-ctr">
<div class="bar">

</div>
</div>
<span>C pthread stack (minimum)</span>
</td>
</tr>
<tr class="placeholder"><td colspan="2"><hr/></td></td>
<tr class="java">
<td class="num">
1 MB
</td>
<td class="name">
<div class="bar-ctr">
<div class="bar">

</div>
</div>
<span>Java thread stack (default)</span>
</td>
</tr>
<tr class="c">
<td class="num">
8 MB
</td>
<td class="name">
<div class="bar-ctr">
<div class="bar">

</div>
</div>
<span>C pthread stack (default, 64-bit Mac OS X)</span>
</td>
</tr>
</table>
</section>

</section>
<section id="multi-core" class="slide level1">
<h1>Multi-core</h1>
<ul>
<li>One scheduler per core, scales well to 32+ cores</li>
<li>Better scalability to more cores is in-progress</li>
<li>Schedulers understand IO (disk, network calls)</li>
<li>No implicit synchronization</li>
</ul>
</section>
<section id="scheduler" class="slide level1">
<h1></h1>
<p><img src="images/scheduler.svg"></p>
</section>
<section id="parse-http" class="slide level1">
<h1></h1>
<pre class="sourceCode erlang"><code class="sourceCode erlang"><span class="co">%% Parse HTTP headers from Socket</span>
<span class="fu">headers(</span><span class="dt">Socket</span><span class="fu">,</span> <span class="dt">Request</span><span class="fu">,</span> <span class="dt">Headers</span><span class="fu">)</span> <span class="kw">-&gt;</span>
    <span class="ch">ok</span> <span class="kw">=</span> <span class="fu">inet:setopts(</span><span class="dt">Socket</span><span class="fu">,</span> <span class="fu">[{</span><span class="ch">active</span><span class="fu">,</span> <span class="ch">once</span><span class="fu">}]),</span>
    <span class="kw">receive</span>
        <span class="fu">{</span><span class="ch">http</span><span class="fu">,</span> <span class="dt">_</span><span class="fu">,</span> <span class="ch">http_eoh</span><span class="fu">}</span> <span class="kw">-&gt;</span>
            <span class="co">%% All of the HTTP headers are parsed</span>
            <span class="fu">handle_request(</span><span class="dt">Socket</span><span class="fu">,</span> <span class="dt">Request</span><span class="fu">,</span> <span class="dt">Headers</span><span class="fu">);</span>
        <span class="fu">{</span><span class="ch">http</span><span class="fu">,</span> <span class="dt">_</span><span class="fu">,</span> <span class="fu">{</span><span class="ch">http_header</span><span class="fu">,</span> <span class="dt">_</span><span class="fu">,</span> <span class="dt">Name</span><span class="fu">,</span> <span class="dt">_</span><span class="fu">,</span> <span class="dt">Value</span><span class="fu">}}</span> <span class="kw">-&gt;</span>
            <span class="fu">headers(</span><span class="dt">Socket</span><span class="fu">,</span> <span class="dt">Request</span><span class="fu">,</span> <span class="fu">[{</span><span class="dt">Name</span><span class="fu">,</span> <span class="dt">Value</span><span class="fu">}</span> <span class="fu">|</span> <span class="dt">Headers</span><span class="fu">]);</span>
        <span class="fu">{</span><span class="ch">tcp_closed</span><span class="fu">,</span> <span class="dt">_</span><span class="fu">}</span> <span class="kw">-&gt;</span>
            <span class="fu">exit(</span><span class="ch">normal</span><span class="fu">);</span>
        <span class="dt">_Other</span> <span class="kw">-&gt;</span>
            <span class="co">%% Invalid request</span>
            <span class="fu">exit(</span><span class="ch">normal</span><span class="fu">)</span>
    <span class="kw">after</span> <span class="fu">?</span><span class="dt">HEADERS_RECV_TIMEOUT</span> <span class="kw">-&gt;</span>
        <span class="fu">exit(</span><span class="ch">normal</span><span class="fu">)</span>
    <span class="kw">end</span><span class="fu">.</span></code></pre>
</section>
<section id="per-process-heaps" class="slide level1">
<h1>Per-process heaps</h1>
<ul>
<li>No sharing</li>
<li>GC is per-process, and not &quot;stop the world&quot;!</li>
<li>Process references do not prevent GC</li>
<li>Explicitly hibernate idle processes for compaction</li>
</ul>
</section>
<section id="no-more-async-callbacks" class="slide level1">
<h1>No More Async Callbacks</h1>
<ul>
<li>Only reason to use async is because threads are expensive</li>
<li>With cheap pre-emptive threads, you can write straightforward and performant code without inverting the control flow</li>
<li>Erlang exceptions propagate along linked processes</li>
</ul>
</section>
<section id="message-passing" class="slide level1">
<h1></h1>
<h3>
RPC with a Counter process
</h3>

<pre class="sourceCode erlang"><code class="sourceCode erlang"><span class="dt">Counter</span> <span class="kw">!</span> <span class="fu">{self(),</span> <span class="fu">{</span><span class="ch">add</span><span class="fu">,</span> <span class="dv">1</span><span class="fu">}},</span>
<span class="kw">receive</span>
  <span class="fu">{</span><span class="dt">Counter</span><span class="fu">,</span> <span class="fu">{</span><span class="ch">result</span><span class="fu">,</span> <span class="dt">N</span><span class="fu">}}</span> <span class="kw">-&gt;</span>
    <span class="fu">io:format(</span><span class="st">&quot;~p~n&quot;</span><span class="fu">,</span> <span class="fu">[</span><span class="dt">N</span><span class="fu">])</span>
<span class="kw">end</span><span class="fu">.</span></code></pre>
</section>
<section id="message-passing-2" class="slide level1">
<h1></h1>
<h3>
RPC with a Counter process
</h3>

<pre class="sourceCode erlang"><code class="sourceCode erlang"><span class="fu">{</span><span class="ch">result</span><span class="fu">,</span> <span class="dt">N</span><span class="fu">}</span> <span class="kw">=</span> <span class="fu">gen_server:call(</span>
  <span class="dt">Counter</span><span class="fu">,</span>
  <span class="fu">{</span><span class="ch">add</span><span class="fu">,</span> <span class="dv">1</span><span class="fu">}).</span></code></pre>
</section>
<section id="resiliency" class="slide level1">
<h1>Resiliency</h1>
<ul>
<li>The Erlang mantra is &quot;let it crash&quot;, don't try and handle every unexpected exception</li>
<li>If a process dies, all of its linked ports and processes also receive an exit signal (which will free any resources such as sockets)</li>
<li>At the top of the tree, a supervisor receives this signal and may restart the process or group of processes</li>
<li>Since processes are isolated with no shared mutable data, this is safe and predictable!</li>
</ul>
</section>
<section id="supervisor" class="slide level1">
<h1></h1>
<svg viewBox="0 0 1000 1000" class="full diagram">
  
<line x1="430" x2="350" y1="220" y2="400" data-link="SupervisorA WorkerA"/> <line x1="570" x2="650" y1="220" y2="400" data-link="SupervisorA SupervisorB"/> <line x1="580" x2="400" y1="570" y2="700" data-link="SupervisorB WorkerB1"/> <line x1="650" x2="650" y1="600" y2="700" data-link="SupervisorB WorkerB2"/> <line x1="720" x2="900" y1="570" y2="700" data-link="SupervisorB WorkerB3"/> <g class="supervisor" transform="translate(500, 150)" data-name="SupervisorA"> <circle r="100"></circle> <text>SupervisorA</text> </g> <g class="worker" transform="translate(350, 500)" data-name="WorkerA"> <circle r="100"></circle> <text>WorkerA</text> </g> <g class="supervisor" transform="translate(650, 500)" data-name="SupervisorB"> <circle r="100"></circle> <text>SupervisorB</text> </g> <g class="worker" transform="translate(400, 800)" data-name="WorkerB1"> <circle r="100"></circle> <text>WorkerB1</text> </g> <g class="worker" transform="translate(650, 800)" data-name="WorkerB2"> <circle r="100"></circle> <text>WorkerB2</text> </g> <g class="worker" transform="translate(900, 800)" data-name="WorkerB3"> <circle r="100"></circle> <text>WorkerB3</text> </g>
</svg>

</section>
<section id="introspection" class="slide level1">
<h1>Introspection</h1>
<ul>
<li>Can get an Erlang shell any networked node</li>
<li>Tracing makes it possible to investigate production internals</li>
<li>Great SNMP support</li>
<li>Very good libraries for monitoring/logging/etc.</li>
</ul>
</section>
<section id="uptime" class="slide level1">
<h1>Uptime</h1>
<ul>
<li>Upgrade services on the fly with hot code loading</li>
<li>It's not possible to have a truly reliable system that runs on a single server, so Erlang has first class distributed support</li>
<li>With a few caveats, communicating from process to process between separate Erlang nodes is seamless. Works with the same syntax and libraries!</li>
</ul>
</section>
<section id="distributed-diagram" class="slide level1">
<h1></h1>
<svg viewBox="0 0 1000 1000" class="full diagram">
  
<g class="host" transform="translate(20,20)" data-host="alto"> <rect width="460" height="900"/> <text x="230" y="1em">alto</text> <g class="node" data-node="alice@alto" transform="translate(30, 100)"> <rect width="400" height="650"/> <text x="200" y="1em">alice@alto</text> <g class="worker" data-name="PidA" transform="translate(200,170)"> <circle r="100"/> <text>PidA</text> </g> <g class="supervisor" data-name="net_kernelA" transform="translate(200,470)"> <line x1="0" y1="100" x2="0", y2="230" class="tcp" data-link="net_kernelA epmdA"/> <line x1="70.71" y1="70.71" x2="300", y2="230" class="tcp phase1" data-link="net_kernelA epmdB"/> <line x1="100" y1="0" x2="400", y2="0" class="tcp phase2" data-link="net_kernelA net_kernelB"/> <circle r="100"/> <text>net_kernel</text> </g> </g> <g class="epmd" transform="translate(30, 800)"> <rect width="400" height="60"/> <text x="200" y="1em">epmd</text> </g> </g> <g class="host" transform="translate(520,20)" data-host="onyx"> <rect width="460" height="900"/> <text x="230" y="1em">onyx</text> <g class="node" data-node="bob@onyx" transform="translate(30, 100)"> <rect width="400" height="650"/> <text x="200" y="1em">bob@onyx</text> <g class="worker" data-name="PidB" transform="translate(200,170)"> <circle r="100"/> <text>PidB</text> </g> <g class="supervisor" data-name="net_kernelB" transform="translate(200,470)"> <line x1="0" y1="100" x2="0", y2="230" class="tcp" data-link="net_kernelB epmdB"/> <circle r="100"/> <text>net_kernel</text> </g> </g> <g class="epmd" transform="translate(30, 800)"> <rect width="400" height="60" data-name="epmdB"/> <text x="200" y="1em">epmd</text> </g> </g>
</svg>

</section>
<section id="not-for-everyone" class="slide level1">
<h1>Not for Everyone</h1>
<ul>
<li>No language is great at everything! Consider a polyglot approach (but don't drive yourself insane with microservices).</li>
<li>Learning a new language takes patience, and you will make more mistakes at first.</li>
<li>When you make mistakes, you should ask for help. Mailing lists, IRC, Twitter, Slack, StackOverflow, etc. can save your project.</li>
</ul>
</section>
<section id="learn-more-erlang" class="slide level1">
<h1>Learn More (Erlang)</h1>
<ul>
<li><a href="http://erlang.org">Erlang.org</a></li>
<li><a href="http://erlang-central.org">Erlang-Central.org</a></li>
<li><a href="http://erlang-factory.com">Erlang-Factory.com</a></li>
<li><a href="http://LearnYouSomeErlang.com">LearnYouSomeErlang.com</a></li>
<li><a href="http://shop.oreilly.com/product/0636920024149.do">Designing for Scalability with Erlang/OTP</a></li>
<li><a href="http://shop.oreilly.com/product/9780596518189.do">Erlang Programming</a></li>
<li><a href="http://chimera.labs.oreilly.com/books/1234000000726">Études for Erlang</a></li>
<li>#erlang on IRC (freenode)</li>
</ul>
</section>
<section id="learn-more-haskell" class="slide level1">
<h1>Learn More (Haskell)</h1>
<dl>
<dt>Books</dt>
<dd><a href="http://learnyouahaskell.com/">Learn You a Haskell for Great Good</a>
</dd>
<dd><a href="http://chimera.labs.oreilly.com/books/1230000000929">Parallel and Concurrent Programming in Haskell</a>
</dd>
<dd><a href="http://haskellbook.com/">Haskell Programming from First Principles</a>
</dd>
<dd><a href="http://book.realworldhaskell.org/">Real World Haskell</a>
</dd>
<dt>Lectures</dt>
<dd><a href="http://www.scs.stanford.edu/11au-cs240h/">Functional Systems in Haskell</a> - CS240h 2011, Stanford
</dd>
<dd><a href="http://shuklan.com/haskell/index.html">Introduction to Haskell</a> - CS1501 Spring 2013, UVA
</dd>
<dd><a href="http://www.seas.upenn.edu/~cis194/">Introduction to Haskell</a> - CIS 194 Spring 2013, UPenn
</dd>
<dd><a href="http://courses.cms.caltech.edu/cs11/material/haskell/">Haskell Track</a> - CS 11 Fall 2011, Caltech
</dd>
<dt>Practice</dt>
<dd><a href="http://exercism.io/">exercism.io</a>, <a href="http://www.talentbuddy.co/">Talentbuddy</a>, <a href="https://www.hackerrank.com/">HackerRank</a>
</dd>
<dd><a href="http://www.haskell.org/haskellwiki/H-99:_Ninety-Nine_Haskell_Problems">H-99</a>, <a href="http://projecteuler.net/">Project Euler</a>
</dd>
</dl>
</section>
<section id="thanks" class="slide level1">
<h1>Thanks!</h1>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 63%" />
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><p><strong>Slides</strong></p></td>
<td style="text-align: left;"><p><a href="http://bob.ippoli.to/fp-htn-2015/">bob.ippoli.to/fp-htn-2015</a></p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p><strong>Source</strong></p></td>
<td style="text-align: left;"><p><a href="https://github.com/etrepum/fp-htn-2015/">github.com/etrepum/fp-htn-2015</a></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p><strong>Email</strong></p></td>
<td style="text-align: left;"><p>bob@redivi.com</p></td>
</tr>
<tr class="even">
<td style="text-align: left;"><p><strong>Twitter</strong></p></td>
<td style="text-align: left;"><p><a href="https://twitter.com/etrepum">@etrepum</a></p></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><p><strong>Related</strong></p></td>
<td style="text-align: left;"><p><a href="http://bob.ippoli.to/intro-to-erlang-2013/">bob.ippoli.to/intro-to-erlang-2013</a><br> <a href="http://bob.ippoli.to/why-haskell-2013/">bob.ippoli.to/why-haskell-2013</a></p></td>
</tr>
</tbody>
</table>
</section>
    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        history: true,
        center: false,
        slideNumber: true,
        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: 'none', // default/cube/page/concave/zoom/linear/fade/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
          { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
//          { src: 'reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; }, }
//          { src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
]});
    </script>
<script src="vendor/jquery-1.11.3.min.js"></script>
<script src="vendor/d3-3.5.5/d3.min.js"></script>
<script src="code.js"></script>
<script>
  var p = window.location.protocol;
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script',(p === 'file:' ? 'https:' : p) + '//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-30504730-1', 'ippoli.to');
  ga('send', 'pageview');

</script>
  </body>
</html>
